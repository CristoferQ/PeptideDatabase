<div class="jumbotron mt-4">
    <h1 class="display-4">Activity prediction for sequences</h1>
    <br>
    <p class="lead">Our classification service facilitates the identification of activities of peptides with unknown function through the use of classification models based on assembled systems of supervised learning algorithms. All the models were generated by coding the sequences from the use of digitized physicochemical properties using Fourier transforms. Assembled models are generated by combining the models generated by the eight properties. Finally, new sequences can be classified according to the categories proposed in our system. One of the great advantages of our system is that the moonlight effect of peptide sequences can be analyzed thanks to the multiple classification system implemented in Peptipedia.</p>
</div>


<div class="card">
    <h5 class="card-header">Inputs</h5>    
    <div class="card-body">
        <form>
            <div class="form-group">
                <label for="exampleFormControlTextarea1">Sequences in FASTA format:</label>
                <textarea class="form-control" id="exampleFormControlTextarea1" rows="8"></textarea>
            </div>
            <div class="text-center">
                <button id="btn1" type='button' class="btn btn-success btn-lg">Calculate</button>
                <button type='button' class="btn btn-dark btn-lg" onclick="javascript:eraseText();">Clear</button>
                <div hidden id="error_alert" class="alert alert-danger mt-3" role="alert">Data entry error</div>
            </div>
            
        </form>
    </div>
    <div hidden id="wait" class="text-center">
    <h2>The results are being processed, this will take a few seconds</h2>
    <i class="fa-5x fas fa-cog fa-spin"></i>
    <br>
    <br>
    </div>
    <div hidden id="all" class="card text-center">
    <h5 class="card-header">Results</h5>    
    <div class="card-body">
        <a id="download" target="_blank">
            <i class="fa fa-download fa-5x" style="color:black"></i>
        </a>
        <br>
        <br>
        <p>The classification system delivers a file in csv format with the id of the sequences entered and the different columns for all the existing categories in the system. Two possible values can be generated for category: 1 in the case of being classified as said activity, 2 otherwise. Remarkably, the sequences can be classified into different activities and the different levels imposed for each category and sub-category are considered. Thus, when a peptide is classified as "Antibacterial", it is also considered as Antimicrobial and Therapeutic.</p>
    </div>
    </div>
</div>



<script>
$("#btn1").click(function(){
    var now = new Date().getTime();
    $('#wait').attr('hidden', false);       
    $('#all').attr('hidden', true);
    $('#error_alert').attr('hidden', true);   
        $.ajax({
            //'url': "http://localhost/classification/results",
            'url': "http://peptipedia.cl/classification/results",
            'method': 'POST',
            'data' : { "sequences" : $("#exampleFormControlTextarea1").val(), "time": now}
        }).done( function(data) {
            console.log(data)
            $('#wait').attr('hidden', true);
            if (data != "error"){
                var dlAnchorElem = document.getElementById('download');
                dlAnchorElem.setAttribute("href", "/jobs/service2/"+now+"/export_category_data.csv");
                dlAnchorElem.setAttribute("download","export_category_data.csv");
                $('#all').attr('hidden', false);
            }
            else{
                $('#all').attr('hidden', true);
                $('#error_alert').fadeIn();;
                $('#error_alert').attr('hidden', false)
                setTimeout(function() {$('#error_alert').fadeOut();}, 3000)
            }
            
            
        });          
});
    
function eraseText() {
    document.getElementById("exampleFormControlTextarea1").value = "";
    $("#exampleFormControlTextarea1").focus();
}

</script>
