<div class="jumbotron mt-4">
    <h1 class="display-4">Activity prediction for sequences</h1>
    <br>
    <p class="lead">Lorem ipsum dolor sit amet consectetur adipisicing elit. Labore quod esse deserunt! Similique maxime sequi et vero eius, atque facere ullam nostrum eaque corrupti incidunt placeat animi facilis explicabo hic.</p>
</div>


<div class="card">
    <h5 class="card-header">Inputs</h5>    
    <div class="card-body">
        <form>
            <div class="form-group">
                <label for="exampleFormControlTextarea1">Sequences in FASTA format:</label>
                <textarea class="form-control" id="exampleFormControlTextarea1" rows="8"></textarea>
            </div>
            <div class="text-center">
                <button id="btn1" type='button' class="btn btn-success btn-lg">Calculate</button>
                <button type='button' class="btn btn-dark btn-lg" onclick="javascript:eraseText();">Clear</button>
                <div hidden id="error_alert" class="alert alert-danger mt-3" role="alert">Data entry error</div>
            </div>
            
        </form>
    </div>
    <div hidden id="wait" class="text-center">
    <h2>The results are being processed, this will take a few seconds</h2>
    <i class="fa-5x fas fa-cog fa-spin"></i>
    <br>
    <br>
    </div>
    <div hidden id="all" class="card text-center">
    <h5 class="card-header">Results</h5>    
    <div class="card-body">
        <a id="download" target="_blank">
            <i class="fa fa-download fa-5x" style="color:black"></i>
        </a>
        <br>
        <br>
        <p>File generated by Peptipedia.</p>
    </div>
    </div>
</div>



<script>
$("#btn1").click(function(){
    var now = new Date().getTime();
    $('#wait').attr('hidden', false);       
    $('#all').attr('hidden', true);
    $('#error_alert').attr('hidden', true);   
        $.ajax({
            'url': "http://localhost/classification/results",
            //'url': "http://45.7.230.112/encoding/results",
            'method': 'POST',
            'data' : { "sequences" : $("#exampleFormControlTextarea1").val(), "time": now}
        }).done( function(data) {
            console.log(data)
            $('#wait').attr('hidden', true);
            if (data != "error"){
                var dlAnchorElem = document.getElementById('download');
                dlAnchorElem.setAttribute("href", "jobs/service2/"+now+"/export_category_data.csv");
                dlAnchorElem.setAttribute("download","export_category_data.csv");
                $('#all').attr('hidden', false);
            }
            else{
                $('#all').attr('hidden', true);
                $('#error_alert').fadeIn();;
                $('#error_alert').attr('hidden', false)
                setTimeout(function() {$('#error_alert').fadeOut();}, 3000)
            }
            
            
        });          
});
    
function eraseText() {
    document.getElementById("exampleFormControlTextarea1").value = "";
    $("#exampleFormControlTextarea1").focus();
}

</script>
